# FOR_aiogram3_router_registration.md — Router Registration Rules (aiogram 3)

## Цель
Подключать модули безопасно и предсказуемо, без “домино” и без конфликтов.

---

## 1) Правило modules-first
- `bot/main.py` регистрирует routers модулей.
- Каждый модуль экспортирует один объект `router` (или функцию `get_router()`), но **единый стиль на проект**.

Рекомендуемый стиль (простой):
- в `bot/modules/<module>/router.py`:
  - `router = Router()` (один на модуль)

---

## 2) Порядок регистрации
- сначала `menu.router`
- потом конкретные модули (в явном списке)
- не использовать “автопоиск по папке”, пока проект маленький (лишняя магия)

---

## 3) Запреты
- не регистрировать один и тот же router дважды
- не делать глобальные wildcard handlers, которые перехватывают чужие события
- не трогать чужие модули при добавлении нового (кроме menu + main registration)

---

## 4) Smoke-проверка после подключения модуля
- /start → меню
- открыть модуль → назад/меню
- nohang на всех inline-кнопках
