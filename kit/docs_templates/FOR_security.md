# FOR_security.md — Security Basics Template (v1)
(минимальная безопасность для Telegram-бота/мини-проекта)

## 0) Цель
Зафиксировать базовые правила безопасности, чтобы:
- не утекли токены/секреты,
- в логах не оказалось персональных данных,
- ошибки пользователю не раскрывали внутренности системы.

---

## 1) Secrets (секреты)
Секреты = то, что нельзя коммитить и нельзя показывать пользователю/в логах:
- `BOT_TOKEN`
- любые API ключи сторонних сервисов
- приватные URL/токены интеграций

Правила:
- секреты хранятся **только в ENV** (`.env` локально, Variables на Railway)
- в репозитории держим только `.env.example`
- никогда не печатать секреты в логах

---

## 2) Git hygiene (чтобы не утекло в git)
Обязательное:
- `.env` в `.gitignore`
- папку данных (например `data/`) — тоже в `.gitignore`, если там пользовательские данные
- любые `*.db`, `*.sqlite`, `*.json` с реальными данными — не коммитить

(если в проекте есть volume JSON: в репо должны быть только пустые примеры или схемы)

---

## 3) Logs (логи)
Правила:
- не логировать содержимое сообщений пользователя целиком
- не логировать: токены, пароли, email/телефон (если такие данные появятся)
- ошибки разработчика (traceback) — в логи, но без секретов

Рекомендация:
- в логах хранить только: событие, module, handler, user_id (если нужно), короткий статус.

---

## 4) Errors (ошибки пользователю)
Пользовательские ошибки:
- коротко и по делу (“Некорректный формат даты. Попробуйте ещё раз.”)
- без stacktrace, без имён файлов, без внутренних деталей

Технические ошибки:
- в лог (с sanitization), пользователю — “Произошла ошибка, попробуйте позже”.

---

## 5) PII / Personal data (если появляется)
Если бот хранит персональные данные:
- минимизировать набор (хранить только то, что нужно)
- описать это в `docs/data_contract.md` (какие поля и зачем)
- предусмотреть очистку данных пользователя (если нужно по продукту)

---

## 6) Railway / Deployment notes (если используешь Railway)
- Secrets только через Variables
- Volume: не хранить секреты в JSON/файлах volume
- Ограничить доступ к репозиторию/логам (кто имеет доступ)

---

## 7) Definition of Done (security)
- [ ] В репо нет секретов (`BOT_TOKEN` нигде не закоммичен)
- [ ] `.env` и `data/` в `.gitignore` (если применимо)
- [ ] Логи не содержат секретов и длинных пользовательских сообщений
- [ ] Пользователь не видит stacktrace/внутренние пути
